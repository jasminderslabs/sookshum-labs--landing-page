---
import TopSection from "../top-section/Topsection.astro";
import TestimonialCard from "./testimonialCard.astro";
const cards = Array.from({ length: 30 }, () => ({
  name: "John Mark",
  title: "CEO of Facebook",
  review: `Lorem ipsum dolor sit amet, consectetur adipisicing elit. Culpa deleniti
    obcaec temporibus autem alias ratione ducimus, minus, consectetur
    adipisicing elit.`,
}));
const topSectionContent = {
  heading: "There are reason people are | about us",
  word: "raving",
  para: `Don't just take our word for it. Explore what our satisfied clients have
      to say about their experience working with our agency`,
  btnText: "Testimonials",
};
---

<section
  class='flex flex-col items-center gap-16 max-w-480 mx-auto md:pt-17.5 pt-15 lg:pt-22.5 xl:pt-30'
>
  <TopSection {...topSectionContent} />
  <div class='relative w-[90%] mx-20'>
    <div
      class='flex overflow-auto no-scrollbar scroll-auto gap-5 endless-scroll'
    >
      {
        cards.map((data) => {
          return <TestimonialCard {...data} />;
        })
      }
    </div>
    <span class='left-blur w-[25%] pointer-events-none'></span>
    <span class='right-blur w-[25%] pointer-events-none'></span>
    <div class='w-full flex justify-center items-center pt-10 xl:pt-20'>
      <a
        href='https://www.designrush.com/'
        target='_blank'
      >
        <div
          class='flex justify-center items-center dark-btn-shadow dropdown-bg dropdown-shadow-button w-33.25 h-31.25 sm:w-35.75 sm:h-33.75 lg:w-38.25 lg:h-36.25 p-2.5 rounded-3xl'
        >
          <div class='bg-white rounded-xl py-2.25 px-4'>
            <img
              src='/award.webp'
              class='object-cover xl:w-25 xl:h-26.5'
            />
          </div>
        </div></a
      >
    </div>
  </div>
</section>
<style>
  .left-blur {
    position: absolute;
    left: -15px;
    top: 0;
    bottom: 0;
    height: 100%;
    z-index: 999;
    opacity: 100%;
    filter: blur(10px);
    background: linear-gradient(90deg, black, transparent);
  }
  .right-blur {
    position: absolute;
    right: -10px;
    top: 0;
    bottom: 0;
    height: 100%;
    opacity: 100%;
    filter: blur(10px);
    background: linear-gradient(90deg, transparent, black);
    z-index: 999;
  }
</style>

<script>
  const scrollbar = document.querySelector(".endless-scroll") as HTMLElement;
  const cards = document.querySelectorAll(".testimonial-card");

  let requestAnimationFrameID: number | null = null;
  let speed = 1;

  function autoScroll() {
    if (!scrollbar) return;

    scrollbar.scrollLeft += speed;

    // When scrolled half (original width), reset smoothly
    if (scrollbar.scrollLeft >= scrollbar.scrollWidth / 2) {
      scrollbar.scrollLeft = 0;
    }

    requestAnimationFrameID = requestAnimationFrame(autoScroll);
  }

  // Pause on hover
  cards.forEach((card) => {
    card.addEventListener("mouseenter", () => {
      if (requestAnimationFrameID) {
        cancelAnimationFrame(requestAnimationFrameID);
      }
    });

    card.addEventListener("mouseleave", () => {
      requestAnimationFrameID = requestAnimationFrame(autoScroll);
    });
  });

  requestAnimationFrameID = requestAnimationFrame(autoScroll);
</script>
