---
import TopSection from "../top-section/Topsection.astro";
import TestimonialCard from "./testimonialCard.astro";

const cards = [
  {
    name: "David Block",
    title: "CEO of Previnex",
    review: `We have been working with Sookshum Labs for close to two years and they are outstanding...`,
    style: "lg:w-[700px] sm:w-[520px] w-[450px]",
  },
  {
    name: "Jeremy Redman",
    title: "CEO of YourVOne",
    review: `Always amazing team to work with and very efficient.`,
    style: "lg:w-[450px] md:w-[380px] sm:w-[350px] w-[300px]",
  },
  {
    name: "Ryan Carter",
    title: "CEO of Torque Digital Media",
    review: `I have worked with Sookshum Labs many times now...`,
    style: "lg:w-[570px] md:w-[450px] w-[380px]",
  },
];

const topSectionContent = {
  heading: "There are reason people are | about us",
  word: "raving",
  para: `Donâ€™t just take our word for it. Explore what our happy clients have to say about their experience working with our agency`,
  btnText: "Testimonials",
};
---

<section
  class='flex flex-col items-center gap-8 md:gap-12 lg:gap-[50px] max-w-480 mx-auto md:pt-17.5 pt-15 lg:pt-30'
>
  <TopSection
    {...topSectionContent}
    wrap='text-wrap lg:text-wrap xl:text-nowrap!'
  />

  <div
    class='relative w-[90%] mx-20 flex flex-col gap-2 md:gap-3 lg:gap-8 xl:gap-0 2xl:gap-5'
  >
    <!-- Scroll Container -->
    <div
      class='flex overflow-x-auto no-scrollbar gap-5 endless-scroll pb-4 md:pb-16 lg:pt-20 lg:pb-17.5'
    >
      {
        cards.concat(cards).map((data) => (
          <div class='testimonial-card'>
            <TestimonialCard {...data} />
          </div>
        ))
      }
    </div>

    <!-- Blur Effects -->
    <span class='left-blur w-[25%] pointer-events-none'></span>
    <span class='right-blur w-[25%] pointer-events-none'></span>

    <!-- Award -->
    <div class='w-full flex justify-center items-center'>
      <a
        href='https://www.designrush.com/'
        target='_blank'
      >
        <div
          class='flex justify-center items-center dark-btn-shadow dropdown-bg dropdown-shadow-button w-33.25 h-31.25 sm:w-35.75 sm:h-33.75 lg:w-38.25 lg:h-36.25 p-2.5 rounded-3xl'
        >
          <div class='bg-white rounded-xl py-2.25 px-4'>
            <img
              src='/award.webp'
              class='object-cover xl:w-25 xl:h-26.5'
            />
          </div>
        </div>
      </a>
    </div>
  </div>
</section>

<style>
  .left-blur {
    position: absolute;
    left: -15px;
    top: 0;
    bottom: 0;
    z-index: 10;
    background-image: linear-gradient(to right, #000, #15151538, transparent);
  }

  .right-blur {
    position: absolute;
    right: -10px;
    top: 0;
    bottom: 0;
    z-index: 10;
    background-image: linear-gradient(to left, #000, #15151538, transparent);
  }

  .endless-scroll {
    scroll-behavior: auto;
    -webkit-overflow-scrolling: touch;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const scrollbar = document.querySelector(".endless-scroll");
    const cards = document.querySelectorAll(".testimonial-card");

    if (!scrollbar) return;

    let requestId;
    const speed = 0.5;

    function autoScroll() {
      scrollbar.scrollLeft += speed;

      // Reset smoothly at end
      if (
        scrollbar.scrollLeft >=
        scrollbar.scrollWidth - scrollbar.clientWidth
      ) {
        scrollbar.scrollLeft = 0;
      }

      requestId = requestAnimationFrame(autoScroll);
    }

    // Pause on hover
    cards.forEach((card) => {
      card.addEventListener("mouseenter", () => {
        if (requestId) cancelAnimationFrame(requestId);
      });

      card.addEventListener("mouseleave", () => {
        requestId = requestAnimationFrame(autoScroll);
      });
    });

    requestId = requestAnimationFrame(autoScroll);
  });
</script>
